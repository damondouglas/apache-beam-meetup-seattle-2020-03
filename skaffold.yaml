apiVersion: skaffold/v2alpha3
kind: Config
metadata:
  name: beam
build:
  tagPolicy:
    envTemplate:
      template: "{{.IMAGE_NAME}}:{{.TAG}}"
  artifacts:
#    - image: tokenizer
#      docker:
#        dockerfile: package/tokenizer
    - image: pipeline
      docker:
        dockerfile: package/pipeline
deploy:
  kubectl: {}
profiles:
  - name: tokenizer
    patches:
      - op: add
        path: /deploy/kubectl
        value:
          manifests:
            - k8s/tokenizer.yaml
  - name: pipeline
    patches:
      - op: add
        path: /deploy/kubectl
        value:
          manifests:
            - k8s/pipeline.yaml
